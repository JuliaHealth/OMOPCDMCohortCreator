<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Beginner Tutorial 🐣 · OMOPCDMCohortCreator.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://JuliaHealth.github.io/OMOPCDMCohortCreator.jl/tutorials/custom_functions/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">OMOPCDMCohortCreator.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../">Tutorials</a></li><li><a class="tocitem" href="../beginner_tutorial/">Beginner Tutorial 🐣</a></li><li><a class="tocitem" href="../r_tutorial/">Using OMOPCDMCohortCreator with R 🏴‍☠️</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Beginner Tutorial 🐣</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Beginner Tutorial 🐣</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaHealth/OMOPCDMCohortCreator.jl/blob/dev/docs/src/tutorials/custom_functions.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Beginner-Tutorial"><a class="docs-heading-anchor" href="#Beginner-Tutorial">Beginner Tutorial 🐣</a><a id="Beginner-Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Beginner-Tutorial" title="Permalink"></a></h1><ul><li><a href="#Beginner-Tutorial">Beginner Tutorial 🐣</a></li><li class="no-marker"><ul><li><a href="#Environment-Set-Up">Environment Set-Up 📝</a></li><li><a href="#Connecting-to-the-Eunomia-Database">Connecting to the Eunomia Database 💾</a></li><li><a href="#Characterizing-Patients-Who-Have-Had-Strep-Throat">Characterizing Patients Who Have Had Strep Throat 🤒</a></li></ul></li><li><a href="#Create-connection-here">Create connection here</a></li><li><a href="#Other-code">Other code</a></li><li class="no-marker"><ul><li><a href="#Conclusion">Conclusion 🎉</a></li><li><a href="#Appendix">Appendix 🕵️</a></li></ul></li></ul><p>This tutorial presents a step by step guide on using OMOPCDMCohortCreator to run a mini characterization study! You will learn the basics of OMOPCDMCohortCreator and how to use it with fake data that you could then apply to your real data sets. Basic knowledge of Julia (such as installing packages into environments and working with the Julia REPL and Julia files) is necessary; you can learn all <a href="https://pkgdocs.julialang.org/v1/getting-started/">that here</a>.</p><h2 id="Environment-Set-Up"><a class="docs-heading-anchor" href="#Environment-Set-Up">Environment Set-Up 📝</a><a id="Environment-Set-Up-1"></a><a class="docs-heading-anchor-permalink" href="#Environment-Set-Up" title="Permalink"></a></h2><p>For this tutorial, you will need to activate an environment; to get into package mode within your Julia REPL, write <code>]</code>:</p><pre><code class="language-julia-repl hljs">pkg&gt; activate TUTORIAL</code></pre><h3 id="Packages"><a class="docs-heading-anchor" href="#Packages">Packages</a><a id="Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Packages" title="Permalink"></a></h3><p>You will need the following packages for this tutorial which you can install in package mode:</p><pre><code class="language-julia-repl hljs">TUTORIAL&gt; add OMOPCDMCohortCreator
TUTORIAL&gt; add SQLite
TUTORIAL&gt; add DataFrames
TURORIAL&gt; add HealthSampleData</code></pre><p>To learn more about these packages, see the <a href="#appendix">Appendix</a>.</p><h3 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h3><p>For this tutorial, we will work with data from <a href="https://github.com/OHDSI/Eunomia">Eunomia</a> that is stored in a SQLite format. To install the data on your machine, execute the following code block and follow the prompts - you will need a stable internet connection for the download to complete: </p><pre><code class="language-julia hljs">import HealthSampleData: Eunomia

eunomia = Eunomia()</code></pre><h2 id="Connecting-to-the-Eunomia-Database"><a class="docs-heading-anchor" href="#Connecting-to-the-Eunomia-Database">Connecting to the Eunomia Database 💾</a><a id="Connecting-to-the-Eunomia-Database-1"></a><a class="docs-heading-anchor-permalink" href="#Connecting-to-the-Eunomia-Database" title="Permalink"></a></h2><p>After you have finished your set up in the Julia, we need to establish a connection to the Eunomia SQLite database that we will use for the rest of the tutorial: </p><pre><code class="language-julia hljs">import SQLite: DB

conn = DB(eunomia)</code></pre><p>With Eunomia, the database&#39;s schema is simply called &quot;main&quot;. We will use this to generate database connection details that will inform <code>OMOPCDMCohortCreator</code> about the type of queries we will write (i.e. SQLite) and the name of the database&#39;s schema. For this step, we will use <code>OMOPCDMCohortCreator</code>:</p><pre><code class="language-julia hljs">import OMOPCDMCohortCreator as occ

occ.GenerateDatabaseDetails(
    :sqlite,
    &quot;main&quot;
)</code></pre><p>Finally, we will generate internal representations of each table found within Eunomia for OMOPCDMCohortCreator to use:</p><pre><code class="language-julia hljs">occ.GenerateTables(conn)</code></pre><p>As a check to make sure everything was correctly installed and works properly, the following block should work and return a list of all person ids in this data:</p><pre><code class="language-julia hljs">occ.GetDatabasePersonIDs(conn)</code></pre><h2 id="Characterizing-Patients-Who-Have-Had-Strep-Throat"><a class="docs-heading-anchor" href="#Characterizing-Patients-Who-Have-Had-Strep-Throat">Characterizing Patients Who Have Had Strep Throat 🤒</a><a id="Characterizing-Patients-Who-Have-Had-Strep-Throat-1"></a><a class="docs-heading-anchor-permalink" href="#Characterizing-Patients-Who-Have-Had-Strep-Throat" title="Permalink"></a></h2><h3 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h3><h3 id="Details"><a class="docs-heading-anchor" href="#Details">Details</a><a id="Details-1"></a><a class="docs-heading-anchor-permalink" href="#Details" title="Permalink"></a></h3><p>how can i execute sql statements against generated tables i had done stmt = DBInterface.prepare(conn, &quot;&quot;&quot;SELECT * FROM  omop.procedure<em>occurrence  LIMIT 1&quot;&quot;&quot;) # prepare a sql statement against the connection; returns a statement object results = DBInterface.execute(stmt) # execute a prepared statement; returns an iterator of rows (property-accessible &amp; indexable) result.column</em>names but it prints just 2-element Vector{String}:  &quot;no<em>nulls&quot;  &quot;yes</em>nulls&quot;</p><p>Jakub Mitura   1 day ago I had looked into your code and you seem to use FunSQL which seem really nice library however when i try to replicate your code I can not get reference to table code: using FunSQL: From,Limit,render</p><p>conn = connect(     Connection,      &quot;host=localhost port=5432 dbname=synthea user=thecedarprince password=pass*&quot; )     GenerateDatabaseDetails(:postgresql, &quot;omop&quot;) GenerateTables(conn)</p><p>q = From(:procedure<em>occurrence)|&gt; Limit(1) |&gt; q -&gt; render(q, dialect=OMOPCDMCohortCreator.dialect) although during initialization I get [ Info: procedure</em>occurrence table generated internally I get error  FunSQL.ReferenceError: cannot find <code>procedure_occurrence</code> Thanks for patience ! Saved for later • Due 24 hours ago</p><p>Jakub Mitura   1 day ago @TheCedarPrince  the funsql way seem very nice just do not have idea how to access tables that during initialization logging info stated it was created</p><p>TheCedarPrince :deciduous<em>tree:  1 day ago Hey  @Jakub Mitura  – I&#39;ll write a tutorial and add that it into the documentation but the short answer to this is as follows. :thumbsup</em>all: 1</p><p>TheCedarPrince :deciduous_tree:  1 day ago using OMOPCDMCohortCreator</p><h1 id="Create-connection-here"><a class="docs-heading-anchor" href="#Create-connection-here">Create connection here</a><a id="Create-connection-here-1"></a><a class="docs-heading-anchor-permalink" href="#Create-connection-here" title="Permalink"></a></h1><h1 id="Other-code"><a class="docs-heading-anchor" href="#Other-code">Other code</a><a id="Other-code-1"></a><a class="docs-heading-anchor-permalink" href="#Other-code" title="Permalink"></a></h1><p>GenerateDatabaseDetails(:postgresql, &quot;omop&quot;) tables = GenerateTables(conn, inplace = false, exported = true) Then, within that tables variable, you can get FunSQL representations of the tables you want: person = tables[:person] :thumbsup_all: 1</p><p>TheCedarPrince :deciduous<em>tree:  1 day ago Then you can write queries such as: sql = From(person) |&gt; Select(Get.person</em>id) |&gt; x -&gt; render(x, :postgresql) DBInterface.execute(conn, sql) |&gt; DataFrame :thumbsup_all: 1</p><p>TheCedarPrince :deciduous<em>tree:  1 day ago Hopefully that should get you unstuck  @Jakub Mitura  and sorry for the delay in response. :thumbsup</em>all: 1</p><p>TheCedarPrince :deciduous_tree:  1 day ago Additionally, the FunSQL reference documentation is fantastic here: https://mechanicalrabbit.github.io/FunSQL.jl/dev/guide/</p><h2 id="Conclusion"><a class="docs-heading-anchor" href="#Conclusion">Conclusion 🎉</a><a id="Conclusion-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusion" title="Permalink"></a></h2><p>This mini characterization study that we just conducted on this dataset opens up a whole new avenue for a researcher to pursue. For example, we could now calculate prevalence rates across different patient characteristics or compare and contrast multiple conditions at once. It should also be apparent that the API is set up in a very particular way: it is functional meaning that each function does one thing only. This gives a lot of flexibility to a user to build together study incrementally using OMOPCDMCohortCreator. Congratulations on finishing this tutorial and if there are any issues you encountered, <a href="https://github.com/JuliaHealth/OMOPCDMCohortCreator.jl/issues/new/choose">feel free to open an issue here</a>!</p><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix 🕵️</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Packages-Used-in-Analysis"><a class="docs-heading-anchor" href="#Packages-Used-in-Analysis">Packages Used in Analysis</a><a id="Packages-Used-in-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Packages-Used-in-Analysis" title="Permalink"></a></h3><p>Package descriptions:</p><ul><li><p><a href="https://github.com/JuliaData/DataFrames.jl"><code>DataFrames</code></a> - Julia&#39;s dataframe handler for easily manipulating data</p></li><li><p><a href="https://github.com/JuliaHealth/OMOPCDMCohortCreator.jl"><code>OMOPCDMCohortCreator</code></a> - Create cohorts from databases utilizing the OMOP CDM</p></li><li><p><a href="https://github.com/JuliaHealth/HealthSampleData.jl"><code>HealthSampleData</code></a> - Sample health data for a variety of health formats and use cases</p></li><li><p><a href="https://github.com/JuliaDatabases/SQLite.jl"><code>SQLite</code></a> - A Julia interface to the SQLite library</p></li></ul></article><nav class="docs-footer"><p class="footer-message">Created by <a href="https://jacobzelko.com">Jacob Zelko</a> &amp; <a href="https://www.gtri.gatech.edu">Georgia Tech Research Institute</a>. <a href="https://github.com/JuliaHealth/OMOPCDMCohortCreator.jl/blob/main/LICENSE">License</a></p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Tuesday 25 June 2024 23:06">Tuesday 25 June 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
